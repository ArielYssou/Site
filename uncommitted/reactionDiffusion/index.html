<!DOCTYPE html>
<html lang='en'>
	<head>

		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, intial-scale=1">

		<!-- Name on tab -->
		<title>TITLE_TAG</title>

		<!-- Google Fonts -->
		<link href="https://fonts.googleapis.com/css?family=Cormorant+Garamond:400,700&display=swap" rel="stylesheet"> 

		<!-- Custom CSS -->
		<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
		<link rel="stylesheet" href="../../css/prism.css"> <!--TARGET-->
		<link rel="stylesheet" href="../../css/style.css"> <!--TARGET-->

		<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
		<script src="https://cdn.jsdelivr.net/npm/p5@0.10.2/lib/p5.js"></script>

		<!-- Custom p5js animations -->
		<script src="sketch.js"></script>

		<!-- MathJax for LaTeX -->
		<script id="MathJax-script" async
						src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
		</script>
	</head>

	<body style="background-color:#42403b">
		<!-- Navigation bar -->
		<nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
			<a class="navbar-brand" href="../.." style="font-weight:bold;">Ariel Yssou</a> <!--TARGET-->
			<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
				<span class="navbar-toggler-icon"></span>
			</button>
			<div class="collapse navbar-collapse" id="navbarSupportedContent">
				<ul class="navbar-nav mr-auto">
					<li class="nav-item">
						<a class="nav-link" href="../.." style="font-weight:bold;">Home </a><!--TARGET-->
 
					</li>
					<li class="nav-item active">
						<a class="nav-link" href="../../blog" style="font-weight:bold;">Blog <span class="sr-only">(current)</span></a><!--TARGET-->
					</li>
					<li class="nav-item">
						<a class="nav-link" href="../../about" style="font-weight:bold;">About</a><!--TARGET-->
					</li>
				</ul>
			</div>
			<div class="collapse navbar-collapse" id="navbarSupportedContent">
				<ul class="navbar-nav ml-auto">
					<li class="nav-item">
						<a class="nav-link text-nowrap" href="https://github.com/ArielYssou" target="_blank"><i class="fab fa-github fa-lg"></i></a>
					</li>
					<li class="nav-item">
						<a class="nav-link text-nowrap" href="https://www.linkedin.com/in/ariel-yssou-oliveira-f-2a07a5b5/" target="_blank"><i class="fab fa-linkedin fa-lg"></i></a>
					</li>
				</ul>
			</div>
		</nav>
		<!-- End of navigation bar -->
		
		<div class="container post_body">
			<div class="row post_struct">
				<div class="col-ld-12">
					<div class="post_cover">
						<div class="blog_title">
							Reaction Diffusion Process
						</div>
					</div>

					<p>In this post we will study the most intriguing Gray Scott model, which describes the reaction between two substances. This model has been the focus of many recent studies (<a href="https://www.researchgate.net/publication/286301765_Information_geometric_analysis_of_phase_transitions_in_complex_patterns_The_case_of_the_Gray-Scott_reaction-diffusion_model" target='_'>[1]</a>, <a href="https://www.sciencedirect.com/science/article/pii/S1468121803000208" target='_'>[2]</a>, <a href="https://arxiv.org/pdf/1610.09097.pdf" target='_'>[3]</a>) for its complex behavior, chaotic nature and relatively simple formulation. It also generates beautifull patterns that are widely used by graphical artists (<a href="https://www.mdpi.com/1424-8220/20/4/1135/htm" target='_'>creating procedual generated textures</a>) and has applications in many theoretical fiels such as biology in the modeling of <a href="https://www.researchgate.net/publication/286301765_Information_geometric_analysis_of_phase_transitions_in_complex_patterns_The_case_of_the_Gray-Scott_reaction-diffusion_model/figures?lo=1" target='_'>human brain development</a> and in physics in the study of <a href="https://www.researchgate.net/publication/286301765_Information_geometric_analysis_of_phase_transitions_in_complex_patterns_The_case_of_the_Gray-Scott_reaction-diffusion_model" target='_'>phase transitions in complex patterns</a>.</p>
					<p>In this post we will focus on how to implementation of such model and discuss some interesting theoretical properties such as its complex phase space. This model may seem simple at first glance, but its implementation will provide some challenges that will help us study very powerfull computational methods that can be used in many implementations and are a valuable tool for any programmer or scientist. </p>
					 <p>The Gray Scott model describes the reaction of two chemicals. A reactant 'B' can transform another reactant 'A' into becoming a innert substance. The evolution of the system is described by the following equations, in terms of the feed rate \(f\), the kill rate \(k\) and the concentration of substances A and B and their diffusion rates \(D_{A,B}\):</p>
					 <p>
					 \(\begin{eqnarray*}
					 \frac{\partial}{\partial t} A(t) =  D_A \nabla^2 A - A B^2 + f (1 - A)\\
					 \frac{\partial}{\partial t} B(t) =  D_B \nabla^2 B + A B^2 - (f + k) B
					 \end{eqnarray*}
					 \)
					 </p>
					 <p>Postponing the theoretical discussion, lets start by solving these equations numerically to get aquainted with the problem. This can be done by considering discrete time intervals and by dividing the system into a grid, where each site has a local concentration of A and B that can difuse to the neighboring sites. These conditions lead us to the following set of equations for the evolution of the system from a time interval \(j\) to the next (nottice that since the particular position in the lattice doesn't matter, we will avoid indexing the position to simplify the notation):</p> 
					 <p>
					 \(\begin{eqnarray*}
					 A_{t+1} =  D_A \nabla^2 A_j - A_j B_j^2 + f (1 - A_j)\\
					 B_{t+1} =  D_B \nabla^2 B_j + A_j B_j^2 - (f + k) B_j
					 \end{eqnarray*}
					 \) 
					 </p>
					 <p>The first question that arises is how to compute the Laplacian operator. The discretization of \(\nabla^2\) can be done in many ways (you can read more about it <a href="https://en.wikipedia.org/wiki/Discrete_Laplace_operator" target='_'>here</a>), but for reasons that will become clear soon we will use the five point stencil method, which comprises of estimating the Laplacian (in a square lattice) via: </p> 
					 <p>\(
					 \begin{equation}
					 \nabla^2 f(x, y) \approx f(x-1, y) + f(x+1, y) + f(x, y-1) + f(x, y+1) - 4 f(x,y)
					 \end{equation}
					 \)
					 </p>
					 <p>This type of discretization is based on an the very familiar Taylor series (<a href="https://en.wikipedia.org/wiki/Finite_difference_method" target='_'>quick "proof"</a>). Implementing these equations is quite straightfoward now, but there is a catch. The most "naive" way to do it leads to rather slow code. You can click it below and see it for yourself (recommended only if your computer has a reasonable ammount of RAM, otherwise you will just need to trust my word that it is, indeed, slow). </p> 

					<div class="sketch-holder" id="c1"></div><br>
					<p>The are some computational bottlenecks in this code. Since it is a small code and fairly simple we can identify them easily, but if you are writing a larger code try studing about bechmark techniques to see what parts of your code are more costly and could use some optmization. Ehile easier and more readable, writting matrices as actual 2D arrays is suboptimal froma computational view. A array is basicaly a pointer that, well, points to a place in memory where the array values are stored squentially. A 2D array is an array of pointers, eeach pointing to the location of a line of the matrix. So every time we acess a 2D array, we have to follow two pointers instead of just 1. If we store the lines of a matrix sequentially in a 1D array we can avoid this, thus optmizing how we access the values of a matrix. Heres a scheme of how this works:</p> 
					<p>Another bottleneck is the calculation the laplatian in each site. One thing that goes unoticed by most is to why squaring a matrix or doing matrix operation in numpy is so "fast". The reason for this that these operations are already <a href="https://www.pythonlikeyoumeanit.com/Module3_IntroducingNumpy/VectorizedOperations.html" target='_'>vectorized</a>, which is a far better and optmized way of peforming array operations. To use the vectorized nature of numpy functions (many scientific packages in the most common programming languages are already optmized and if you don't care much for how things work you might just trust the people that wrote these packages, but if you like reading about algorithms and optmization this topic of operation vectorization is very enriching and powerful), we need to find a way to write the laplatian operator as a matrix. If you need to apply an operator in any future code try writing it as a matrix and use the optmized functions of the language to full effects.</p>
					<p>Lets begin thinking that there is only one active site and its nearest neighbors. The laplatian could be written as:<p>
					<p>It becomes clear that we need a matrix operator for each site of the lattice. Since there are \($n^2$\) sites we will need to build a $n^2 \times n^2$ operator where each line is a matrix that will act in a single site. We can construct the 5 point stencil Laplatian operator as:</p>
					<p>Implementing these changes we can see that the codes runs much MUCH faster. With this we can explore some know parameter combnations and see the sheer variety of patterns that a single model can generate. The "complexity" of each configuration can be measured by quantities scuh as the Shannon entropy \($$H = -\sum_{w \in W} (\nu(w) / \eta ) \ln (\nu(w) / \eta),$$\) and the Simpson's diversity \($$S = \sum_{w \in W} (\nu(w) / \eta)^2. $$\)i, These measures can be used to desribe the phase diagram of the system, as we will see shortly.</p>
					<p></p>  
					<p>The full phase diagram of this system in terms of the complexity of each patterns is quite intricate as well. Refering to the excelent artivle [1], the diagram is:</p> 
					<p>Where we took care to label our configurations after the same cases studied in this article so the labels would match exactly. Many more interesting things could be studied, but as a closing note lets try to visualize the full phase diagram. This can be done by making a simulation where the paramenters depend on the location of the lattice, thus each part of the system will be in a diferent regime. The result is as follows:</p> 
					<!--<div class="sketch-holder" id="c2"></div>-->
					<p>Thanks or reading!</p> 
					
					Code:
					<pre data-src="sketch.js" class="line-numbers my_code"></pre>

				</div>
			</div>
		</div>

		<hr/>
		<script src="../../js/script.js"> </script><!--TARGET-->
		<script src="../../js/prism.js"> </script><!--TARGET-->
		<!-- Bootstrap + JQuery -->
		<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
		<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>

		<script src="https://kit.fontawesome.com/9ead9d8df4.js" crossorigin="anonymous"></script>


	</body>
</html>
